function redirectToProfile(n){window.location.href=profileRedirectUrl+"?codePAR="+n}function updateAffiliateRowAndChart(n){var t=document.querySelector(`.affiliate-wrapper[data-codepar='${n.affiliate}']`),i,r,u,f;if(t){t.querySelector(".clicks-data").textContent=n.totalClicks;t.querySelector(".sales-data").textContent=n.totalSales.toFixed(2)+" zł";t.querySelector(".fullClicks-data").textContent=n.fullClicks;t.querySelector(".fullOrders-data").textContent=n.fullOrders;t.querySelector(".fullSales-data").textContent=n.fullSales.toFixed(2)+" zł";t.querySelector(".orders-data").textContent=n.totalOrders;i=updateOrdersToClicksRatio(n.totalOrders,n.totalClicks);t.querySelector(".ordersToClicksRatio").textContent=i;r=updateFullOrdersToClicksRatio(n.fullOrders,n.fullClicks);t.querySelector(".fullOrdersToClicksRatio").textContent=r;t.setAttribute("data-creation-date",n.creationDate);u=new Date(n.creationDate);f=u.toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"});t.querySelector(".creationDate-data").textContent=f;var e=n.clicks.map(n=>n.clickTime.substring(0,10)),o=n.clicks.map(n=>n.count),s=n.sales.map(n=>n.amount),h=t.querySelector(".chart-container canvas").getContext("2d");createChart(h,e,o,s)}}function createChart(n,t,i,r){var u=n.createLinearGradient(0,0,0,n.canvas.clientHeight),f,e;u.addColorStop(0,"rgba(14, 126, 135, 0.2)");u.addColorStop(1,"rgba(14, 126, 135, 0.6)");f=n.createLinearGradient(0,0,0,n.canvas.clientHeight);f.addColorStop(0,"rgba(246, 80, 99, 1");f.addColorStop(1,"rgba(247, 128, 95, 1)");e=new Chart(n,{type:"bar",data:{labels:t,datasets:[{label:"Sprzedaż",data:r,barThickness:10,backgroundColor:"rgba(255, 255, 255, 0.6)",borderColor:"rgba(255, 255, 255, 0.6)",borderWidth:1,borderRadius:2,yAxisID:"ySales"},{label:"Ruch na stronę:",data:i,type:"line",backgroundColor:u,borderColor:"rgba(14, 126, 135, 1)",borderWidth:2,fill:!0,tension:.5,yAxisID:"yClicks"}]},options:{maintainAspectRatio:!1,scales:{x:{display:!1,offset:!1,grid:{color:"rgba(255, 255, 255, 0.8)"}},yClicks:{display:!0,type:"linear",position:"left",beginAtZero:!0,suggestedMax:100,title:{display:!1,text:"Ruch",color:"rgba(255, 255, 255, 0.8",font:{size:12,weight:"regular"}},ticks:{color:"rgba(255, 255, 255, 0.8"}},ySales:{display:!0,type:"linear",position:"right",color:"rgba(255, 255, 255, 0.8)",beginAtZero:!1,suggestedMax:500,grid:{drawOnChartArea:!1},title:{display:!1,text:"Sprzedaż",color:"rgba(255, 255, 255, 0.8)",font:{size:12,weight:"regular"}},ticks:{color:"rgba(255, 255, 255, 0.8",callback:function(n){return n.toFixed(2)+" zł"}}}},elements:{point:{radius:0,hoverRadius:6,hoverBorderWidth:2}},plugins:{legend:{display:!1,labels:{color:"rgba(0, 69, 82, 1)",font:{size:15}}},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(n){var t=n.dataset.label||"",i=n.parsed.y;return t==="Sprzedaż"?t+": "+parseFloat(i).toFixed(2)+" zł":t+": "+i}}}}}})}function updateOrdersToClicksRatio(n,t){var i=0;return t>0&&(i=n/t*100),i.toFixed(2)+" %"}function updateFullOrdersToClicksRatio(n,t){var i=0;return t>0&&(i=n/t*100),i.toFixed(2)+" %"}function updateView(n){var t=document.querySelector(".Vert-affiliate"),i;t.innerHTML="";i=new Date;n.forEach(n=>{var u=new Date(n.getAttribute("data-creation-date")),f=Math.abs(i-u),e=Math.ceil(f/864e5),r;e<=14&&(r=n.querySelector(".new-affiliate"),r&&(r.style.display="block"));t.appendChild(n)});n.sort((n,t)=>{var i=parseFloat(n.querySelector(".fullSales-data").textContent),r=parseFloat(t.querySelector(".fullSales-data").textContent);return r-i});n.forEach((n,t)=>{if(t<10){var i=n.querySelector(".top-affiliate");i&&(i.textContent="TOP "+(t+1),i.style.display="block")}})}function sortAffiliatesBySales(n){var t=Array.from(document.querySelectorAll(".affiliate-wrapper"));t.sort((t,i)=>{var r=parseFloat(t.querySelector(".fullSales-data").textContent),u=parseFloat(i.querySelector(".fullSales-data").textContent);return n?u-r:r-u});updateView(t)}function sortAffiliatesByJoinDate(n){var t=Array.from(document.querySelectorAll(".affiliate-wrapper"));t.sort((t,i)=>{var r=new Date(t.getAttribute("data-creation-date")),u=new Date(i.getAttribute("data-creation-date"));return n?u-r:r-u});updateView(t)}$(document).ready(function(){$("#campaignSearch").on("keyup",function(){var n=$(this).val().toLowerCase();$(".affiliate-wrapper").filter(function(){$(this).toggle($(this).find(".campaign-box-head-name").text().toLowerCase().indexOf(n)>-1)})})});document.addEventListener("DOMContentLoaded",function(){fetch(affiliatesDataUrl).then(n=>n.json()).then(n=>{var t=n.map(n=>(updateAffiliateRowAndChart(n),document.querySelector(`.affiliate-wrapper[data-codepar='${n.affiliate}']`)));updateView(t);$("#sortNewest").addClass("selected")}).catch(n=>console.error("Error:",n))});$(document).ready(function(){$(".Select-Line button").click(function(){$(".Select-Line button").removeClass("selected");$(this).addClass("selected")});$("#sortHighestSales").click(()=>sortAffiliatesBySales(!0));$("#sortLowestSales").click(()=>sortAffiliatesBySales(!1));$("#sortNewest").click(()=>sortAffiliatesByJoinDate(!0));$("#sortOldest").click(()=>sortAffiliatesByJoinDate(!1))});