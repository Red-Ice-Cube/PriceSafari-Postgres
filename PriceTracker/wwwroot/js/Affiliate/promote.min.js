function getProductData(n){return fetch("/Promote/GetProductData?productId="+n).then(n=>{if(!n.ok)throw new Error("Network response was not ok");return n.json()}).then(n=>({productId:n.productId,productName:n.productName,productImage:n.productImage})).catch(n=>{console.error("There has been a problem with your fetch operation:",n)})}function addProductToCartUI(n){const t=document.querySelector(".Generate-Box-Box-List");getProductData(n).then(i=>{const r=`
                    <div class="cart-item" data-product-id="${n}">
                        <img src="${i.productImage}" alt="${i.productName}" width="50" height="50" />
                        ${i.productName}
                        <button onclick="removeFromCart('${n}')" class="remove-from-cart" data-product-id="${n}">Usuń</button>
                    </div>
                `;t.innerHTML+=r}).catch(n=>{console.error("Error fetching product data:",n)})}function removeProductFromCartUI(n){const t=document.querySelector(".Generate-Box-Box-List"),i=t.querySelector(`.cart-item[data-product-id="${n}"]`);i&&t.removeChild(i)}function addToCart(n,t){let i=JSON.parse(localStorage.getItem("cart"))||[];if(i.length>=16&&!i.includes(n)){showAlert("Osiągnąłeś limit 16 produktów w generatorze. Usuń niektóre produkty, aby dodać nowe.");t(!1);return}i.includes(n)?t(!1):(i.push(n),localStorage.setItem("cart",JSON.stringify(i)),addProductToCartUI(n),t(!0))}function removeFromCart(n){let t=JSON.parse(localStorage.getItem("cart"))||[];const r=16,i=t.indexOf(n);if(i>-1){t.splice(i,1);localStorage.setItem("cart",JSON.stringify(t));removeProductFromCartUI(n);t.length<r&&document.querySelectorAll(".add-to-cart").forEach(n=>{n.disabled=!1,n.style.pointerEvents="auto"});const u=document.querySelector(`.add-to-cart[data-product-id="${n}"]`);u&&(u.style.display="block");const f=document.querySelector(`.added-to-cart[data-product-id="${n}"]`);f&&(f.style.display="none")}}function goToGenerate(){const n=JSON.parse(localStorage.getItem("cart"))||[],t=16;n.length===0?showAlert("Musisz dodać przynajmniej jeden produkt do generatora, aby wygenerować kampanię."):n.length>t?showAlert(`Możesz dodać maksymalnie ${t} produktów do koszyka.`):window.location.href="/Promote/Generate?ids="+n.join(",")}function showAlert(n){let t=document.getElementById("alertContainer");t||(t=document.createElement("div"),t.id="alertContainer",document.body.appendChild(t));t.innerHTML="";const i=document.createElement("div");i.innerHTML=[`<div class="alert alert-danger d-flex align-items-center justify-content-center" role="alert" style="min-height: 50px; max-width: 80%; margin: 0 auto; color: #FFF; background: rgba(255, 0, 0, 0.76); padding: 0.4rem 1.2rem; position: fixed; bottom: 50px; left: 50%; transform: translateX(-50%); z-index: 1000;">`,`   <div class="text-center">${n}</div>`,"<\/div>"].join("");t.append(i);setTimeout(()=>{i.remove()},3e3)}function sortProducts(n){const t=document.querySelector(".Products-Box-Product");let i=document.querySelectorAll(".Product-Container");for(i=Array.from(i),document.querySelectorAll(".button-sort").forEach(n=>{n.style.background="#F1F1F1"}),n===lastDirection?lastDirection="":(lastDirection=n,document.getElementById(`sort-${n}`).style.background="#DADADA",i.sort((t,i)=>{const r=parseInt(t.querySelector(".Product-Container-Data-Bottom-Left-Up").textContent.trim().replace(" zł",""),10),u=parseInt(i.querySelector(".Product-Container-Data-Bottom-Left-Up").textContent.trim().replace(" zł",""),10);return n==="asc"?r-u:u-r}));t.firstChild;)t.removeChild(t.firstChild);i.forEach(n=>{t.appendChild(n)})}document.addEventListener("DOMContentLoaded",function(){function r(){const n=JSON.parse(localStorage.getItem("cart"))||[];n.forEach(n=>{const t=document.querySelector(`.add-to-cart[data-product-id="${n}"]`),i=document.querySelector(`.added-to-cart[data-product-id="${n}"]`);t&&(t.style.display="none");i&&(i.style.display="block")});const t=document.querySelector(".Generate-Box-Box-List");t.innerHTML="";n.forEach(n=>{addProductToCartUI(n)})}function u(){const i=Array.from(n).filter(n=>n.checked).map(n=>n.value);i.length===0?t.forEach(n=>n.style.display=""):t.forEach(n=>{const t=n.getAttribute("data-category-id");n.style.display=i.includes(t)?"":"none"})}const n=document.querySelectorAll("input[name='selectedCategories']"),t=document.querySelectorAll(".Product-Container"),i=document.getElementById("showAllProducts");r();n.forEach(n=>{n.addEventListener("change",u)});i.addEventListener("click",function(){n.forEach(n=>n.checked=!1);t.forEach(n=>n.style.display="")})});const addToCartButtons=document.querySelectorAll(".add-to-cart");addToCartButtons.forEach(n=>{n.addEventListener("click",function(){const t=n.getAttribute("data-product-id");addToCart(t,function(i){if(i){n.style.display="none";const i=document.querySelector(`.added-to-cart[data-product-id="${t}"]`);i&&(i.style.display="block")}})})});const generateLink=document.getElementById("generateLink");generateLink.addEventListener("click",function(n){n.preventDefault();goToGenerate()});$(document).ready(function(){$("#productSearch").on("keyup",function(){var n=$(this).val().toLowerCase();$(".Product-Container").filter(function(){$(this).toggle($(this).find(".Product-Container-Data-Top").text().toLowerCase().indexOf(n)>-1)})})});let lastDirection="";