function showClicksChart(){$("#earningsChart").hide();$("#ordersChart").hide();$("#salesChart").hide();$("#clicksChart").show()}function showEarningsChart(){$("#clicksChart").hide();$("#ordersChart").hide();$("#salesChart").hide();$("#earningsChart").show()}function showOrdersChart(){$("#clicksChart").hide();$("#earningsChart").hide();$("#salesChart").hide();$("#ordersChart").show()}function showSalesChart(){$("#clicksChart").hide();$("#ordersChart").hide();$("#earningsChart").hide();$("#salesChart").show()}function showcategoryClicksChart(){$("#categoryEarningsChart").hide();$("#tableCategoryEarningsChart").hide();$("#categoryClicksChart").show();$("#tableCategoryClicksChart").show()}function showcategoryEarningsChart(){$("#categoryClicksChart").hide();$("#tableCategoryClicksChart").hide();$("#categoryEarningsChart").show();$("#tableCategoryEarningsChart").show()}function updateEPC(n,t){var i=0;n>0&&(i=n/t);$("#EPC").text(i.toFixed(2)+" zł")}function updateCR(n,t){var i=0;t>0&&(i=n/t*100);$("#CR").text(i.toFixed(2)+" %")}$(document).ready(function(){function y(n,t){i.data.labels=n;i.data.datasets[0].data=t;i.update()}function p(n,t){r.data.labels=n;r.data.datasets[0].data=t;r.update()}function w(n,t){u.data.labels=n;u.data.datasets[0].data=t;u.update()}function b(n,t){f.data.labels=n;f.data.datasets[0].data=t;f.update()}function k(n){var t=$("#categoryTableBody");t.empty();$.each(n,function(n,i){t.append("<tr><td>"+i.categoryName+"<\/td><td>"+i.categoryClickCount+"<\/td><\/tr>")})}function d(n){var t=$("#earningsTableBody");t.empty();$.each(n,function(n,i){t.append("<tr><td>"+i.category+"<\/td><td>"+parseFloat(i.earnings).toFixed(2)+" zł<\/td><\/tr>")})}function g(n){var t=[],i=[];$.each(n,function(n,r){t.push(r.categoryName);i.push(r.categoryClickCount)});e.data.labels=t;e.data.datasets[0].data=i;e.update()}function nt(n){var t=[],i=[];$.each(n,function(n,r){t.push(r.category);i.push(r.earnings)});o.data.labels=t;o.data.datasets[0].data=i;o.update()}function n(n,t){$('input[name="StartDate"]').val(moment(n).format("YYYY-MM-DD"));$('input[name="EndDate"]').val(moment(t).format("YYYY-MM-DD"));$("#dateRangeForm").submit()}function tt(){var n=$('input[name="StartDate"]').val(),t=$('input[name="EndDate"]').val();$(".dateShortcut").removeClass("selected");n&&t&&$("#dateRangeForm").submit()}function it(n){var i=document.getElementById("walletChart").getContext("2d");t&&typeof t.destroy=="function"&&t.destroy();t=new Chart(i,{type:"line",data:{labels:n.map(n=>n.date),datasets:[{label:"Prowizja w walidacji",data:n.map(n=>n.inValidationEarnings),backgroundColor:"rgba(0, 255, 240, 0.4)",borderColor:"rgba(14, 126, 135, 1)",borderWidth:2,tension:.4,fill:!0},{label:"Prowizja do wypłaty",data:n.map(n=>n.acceptedEarnings),backgroundColor:"rgba(14, 126, 135, 1)",borderColor:"rgba(14, 126, 135, 1)",tension:.4,borderWidth:2,fill:!0}]},options:{maintainAspectRatio:!1,scales:{x:{display:!1,grid:{color:"rgba(40, 40, 40, 0.7)"}},y:{display:!1,beginAtZero:!0,grid:{color:"rgba(255, 255, 255, 0.1)"},suggestedMax:50,ticks:{display:!1,callback:function(n){return n.toFixed(2)+" zł"}}}},elements:{point:{radius:0,hoverRadius:6,hoverBorderWidth:2}},plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(n){var t=n.dataset.label||"";return t&&(t+=": "),n.parsed.y!==null&&(t+=parseFloat(n.parsed.y).toFixed(2)+" zł"),t}}}}}})}var s=document.getElementById("clicksChart").getContext("2d"),i=new Chart(s,{type:"bar",data:{labels:"modelTimeLabels",datasets:[{label:"Kliknięcia",data:"clicks",backgroundColor:"rgba(0, 69, 82, 0.7)",tension:.1,fill:"origin",minBarLength:3,borderWidth:2,borderRadius:4,fill:!0,borderColor:"rgba(0, 69, 82, 1)"}]},options:{maintainAspectRatio:!1,scales:{x:{grid:{color:"rgba(40, 40, 40, 0)"},title:{display:!1,text:"Data",color:"rgba(0, 0, 0, 0.2)",font:{size:18,weight:"regular"}}},y:{beginAtZero:!0,suggestedMax:50,grid:{color:"rgba(40, 40, 40, 0.2)"},title:{display:!1,text:"Kliknięcia",color:"rgba(0, 69, 82, 1)",font:{size:18,weight:"regular"}}}},elements:{point:{radius:0,hoverRadius:6,hoverBorderWidth:2}},plugins:{legend:{display:!1,labels:{color:"rgba(0, 69, 82, 1)",font:{size:15}}},tooltip:{mode:"index",intersect:!1}}}}),h=document.getElementById("earningsChart").getContext("2d"),r=new Chart(h,{type:"bar",data:{labels:"modelTimeLabels",datasets:[{label:"Zarobiona prowizja",data:"earnings",backgroundColor:"rgba(40, 160, 151, 0.8)",tension:.1,fill:"origin",minBarLength:3,borderWidth:2,borderRadius:4,fill:!0,borderColor:"rgba(40, 160, 151, 1)"}]},options:{maintainAspectRatio:!1,scales:{x:{grid:{color:"rgba(40, 40, 40, 0)"},title:{display:!1,text:"Data",color:"rgba(0, 0, 0, 0.2)",font:{size:18,weight:"regular"}}},y:{beginAtZero:!0,suggestedMax:100,ticks:{callback:function(n){return n.toFixed(2)+" zł"}},grid:{color:"rgba(40, 40, 40, 0.2)"},title:{display:!1,text:"Zarobki",color:"rgba(0, 69, 82, 1)",font:{size:18,weight:"regular"}}}},elements:{point:{radius:0,hoverRadius:6,hoverBorderWidth:2}},plugins:{legend:{display:!1,labels:{color:"rgba(0, 69, 82, 1)",font:{size:15}}},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(n){var t=n.parsed.y;return"Zarobki: "+parseFloat(t).toFixed(2)+" zł"}}}}}}),c=document.getElementById("ordersChart").getContext("2d"),u=new Chart(c,{type:"bar",data:{labels:"modelTimeLabels",datasets:[{label:"Zamówienia",data:"orders",backgroundColor:"rgba(6, 99, 108, 0.8)",tension:.1,fill:"origin",minBarLength:3,borderWidth:2,borderRadius:4,fill:!0,borderColor:"rgba(6, 99, 108, 1)"}]},options:{maintainAspectRatio:!1,scales:{x:{grid:{color:"rgba(40, 40, 40, 0)"},title:{display:!1,text:"Data",color:"rgba(0, 0, 0, 0.2)",font:{size:18,weight:"regular"}}},y:{beginAtZero:!0,suggestedMax:10,grid:{color:"rgba(40, 40, 40, 0.2)"},title:{display:!1,text:"Zamówienia",color:"rgba(0, 69, 82, 1)",font:{size:18,weight:"regular"}}}},elements:{point:{radius:0,hoverRadius:6,hoverBorderWidth:2}},plugins:{legend:{display:!1,labels:{color:"rgba(0, 69, 82, 1)",font:{size:15}}},tooltip:{mode:"index",intersect:!1}}}}),l=document.getElementById("salesChart").getContext("2d"),f=new Chart(l,{type:"bar",data:{labels:"modelTimeLabels",datasets:[{label:"Wartość zamówień",data:"sales",backgroundColor:"rgba(14, 126, 135, 0.8)",tension:.1,fill:"origin",minBarLength:3,borderWidth:2,borderRadius:4,fill:!0,borderColor:"rgba(14, 126, 135, 1)"}]},options:{maintainAspectRatio:!1,scales:{x:{grid:{color:"rgba(40, 40, 40, 0)"},title:{display:!1,text:"Data",color:"rgba(0, 0, 0, 0.2)",font:{size:18,weight:"regular"}}},y:{beginAtZero:!0,suggestedMax:1e3,ticks:{callback:function(n){return n.toFixed(2)+" zł"}},grid:{color:"rgba(40, 40, 40, 0.2)"},title:{display:!1,text:"Zamówienia",color:"rgba(0, 69, 82, 1)",font:{size:18,weight:"regular"}}}},elements:{point:{radius:0,hoverRadius:6,hoverBorderWidth:2}},plugins:{legend:{display:!1,labels:{color:"rgba(0, 69, 82, 1)",font:{size:15}}},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(n){var t=n.parsed.y;return"Wartość zamówień: "+parseFloat(t).toFixed(2)+" zł"}}}}}}),t;$("#showClicksChart").click(showClicksChart);$("#showEarningsChart").click(showEarningsChart);$("#showOrdersChart").click(showOrdersChart);$("#showSalesChart").click(showSalesChart);$("#showcategoryClicksChart").click(showcategoryClicksChart);$("#showcategoryEarningsChart").click(showcategoryEarningsChart);var a=document.getElementById("categoryClicksChart").getContext("2d"),e=new Chart(a,{type:"doughnut",data:{labels:[],datasets:[{data:[],backgroundColor:["rgba(68, 240, 240, 1)","rgba(65, 199, 199, 1)","rgba(72, 151, 151, 1)","rgba(68, 182, 154, 1)","rgba(76, 131, 117, 1)","rgba(71, 117, 117, 1)","rgba(80, 110, 128, 1)","rgba(72, 87, 125, 1)"],borderColor:["rgba(68, 240, 240, 1)","rgba(65, 199, 199, 1)","rgba(72, 151, 151, 1)","rgba(68, 182, 154, 1)","rgba(76, 131, 117, 1)","rgba(71, 117, 117, 1)","rgba(80, 110, 128, 1)","rgba(72, 87, 125, 1)"],borderWidth:1}]},options:{aspectRatio:1.3,plugins:{legend:{display:!1,position:"right",labels:{usePointStyle:!0,padding:16,generateLabels:function(n){const i=Chart.overrides.doughnut.plugins.legend.labels.generateLabels,t=i.call(this,n);return t.forEach(n=>{n.text="   "+n.text}),t}}},tooltip:{callbacks:{label:function(n){var t=n.parsed;return"Kliki: "+t}}}}}}),v=document.getElementById("categoryEarningsChart").getContext("2d"),o=new Chart(v,{type:"doughnut",data:{labels:[],datasets:[{data:[],backgroundColor:["rgba(255, 230, 141, 1)","rgba(255, 201, 120, 1)","rgba(255, 188, 87, 1)","rgba(255, 158, 87, 1)","rgba(247, 128, 95, 1)","rgba(243, 98, 118, 1)","rgba(232, 84, 104, 1)","rgba(233, 88, 149, 1)",],borderColor:["rgba(255, 230, 141, 1)","rgba(255, 201, 120, 1)","rgba(255, 188, 87, 1)","rgba(255, 158, 87, 1)","rgba(247, 128, 95, 1)","rgba(243, 98, 118, 1)","rgba(232, 84, 104, 1)","rgba(233, 88, 149, 1)",],borderWidth:1}]},options:{aspectRatio:1.3,plugins:{legend:{display:!1,position:"right",labels:{usePointStyle:!0,padding:16,generateLabels:function(n){const i=Chart.overrides.doughnut.plugins.legend.labels.generateLabels,t=i.call(this,n);return t.forEach(n=>{n.text="   "+n.text}),t}}},tooltip:{padding:10,callbacks:{label:function(n){var t=n.parsed;return"Zarobki: "+parseFloat(t).toFixed(2)+" zł"}}}}}});$(".dateShortcut").click(function(){switch($(this).data("range")){case"today":n(moment(),moment());break;case"yesterday":n(moment().subtract(1,"days"),moment().subtract(1,"days"));break;case"this-week":n(moment().startOf("isoWeek"),moment().endOf("isoWeek"));break;case"last-week":n(moment().subtract(1,"week").startOf("isoWeek"),moment().subtract(1,"week").endOf("isoWeek"));break;case"this-month":n(moment().startOf("month"),moment().endOf("month"))}});$('input[name="StartDate"], input[name="EndDate"]').change(tt);t=null;$("#dateRangeForm").submit(function(n){n.preventDefault();var t=$(this).serialize();$.ajax({type:"POST",url:"/Panel/Index",data:t,dataType:"json",success:function(n){y(n.modelTimeLabels,n.clicks);let t=n.earnings.map(n=>parseFloat(n).toFixed(2));p(n.modelTimeLabels,t);w(n.modelTimeLabels,n.orders);let i=n.sales.map(n=>parseFloat(n).toFixed(2));b(n.modelTimeLabels,n.sales);k(n.categoryClicks);g(n.categoryClicks);d(n.categoryEarnings);nt(n.categoryEarnings);$("#totalClicks").text(n.totalClicksDuringPeriod);$("#totalEarnings").text(parseFloat(n.totalEarningsDuringPeriod).toFixed(2)+" zł");$("#totalSales").text(parseFloat(n.totalSalesDuringPeriod).toFixed(2)+" zł");$("#totalOrders").text(n.totalOrdersDuringPeriod);$("#acceptedEarnings").text(parseFloat(n.acceptedEarningsDuringPeriod).toFixed(2)+" zł");$("#acceptedSales").text(parseFloat(n.acceptedSalesDuringPeriod).toFixed(2)+" zł");$("#acceptedOrders").text(n.acceptedOrdersDuringPeriod);$("#canceledEarnings").text(parseFloat(n.canceledEarningsDuringPeriod).toFixed(2)+" zł");$("#canceledSales").text(parseFloat(n.canceledSalesDuringPeriod).toFixed(2)+" zł");$("#canceledOrders").text(n.canceledOrdersDuringPeriod);updateEPC(parseFloat(n.totalEarningsDuringPeriod),parseFloat(n.totalClicksDuringPeriod));updateCR(n.totalOrdersDuringPeriod,n.totalClicksDuringPeriod);it(n.walletData)},error:function(n){console.error("Błąd podczas aktualizacji danych",n)}})});n(moment().startOf("month"),moment().endOf("month"))});document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".agregationShortcut").forEach(n=>{n.addEventListener("click",function(){document.querySelectorAll(".agregationShortcut").forEach(n=>{n.classList.remove("selected")});n.classList.add("selected")})});document.querySelectorAll(".categoryShortcut").forEach(n=>{n.addEventListener("click",function(){document.querySelectorAll(".categoryShortcut").forEach(n=>{n.classList.remove("selected")});n.classList.add("selected")})});document.querySelectorAll(".dateShortcut").forEach(n=>{n.addEventListener("click",function(){document.querySelectorAll(".dateShortcut").forEach(n=>{n.classList.remove("selected")});n.classList.add("selected")})})});