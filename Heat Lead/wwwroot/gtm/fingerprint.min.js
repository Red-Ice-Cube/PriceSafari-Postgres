function getCanvasFingerprint(){return new Promise(n=>{const i=document.createElement("canvas"),t=i.getContext("2d");i.width=240;i.height=60;t.textBaseline="alphabetic";t.fillStyle="#f60";t.fillRect(100,1,62,20);t.fillStyle="#069";t.font='11pt "Times New Roman"';let r="Cwm fjord bank glyphs vext quiz";t.fillText(r,2,15);t.fillStyle="rgba(102, 204, 0, 0.7)";t.font="18pt Arial";t.fillText(r,4,45);t.globalCompositeOperation="multiply";t.fillStyle="rgb(255,0,255)";t.beginPath();t.arc(50,50,50,0,Math.PI*2,!0);t.closePath();t.fill();t.fillStyle="rgb(0,255,255)";t.beginPath();t.arc(100,50,50,0,Math.PI*2,!0);t.closePath();t.fill();t.fillStyle="rgb(255,255,0)";t.beginPath();t.arc(75,100,50,0,Math.PI*2,!0);t.closePath();t.fill();t.globalCompositeOperation="destination-over";t.fillRect(0,0,240,60);const u=i.toDataURL();n(hashString(u))})}function getWebGLFingerprint(){return new Promise(n=>{var i=document.createElement("canvas"),t=i.getContext("webgl")||i.getContext("experimental-webgl");if(!t){n("WebGL not supported");return}var r=t.getExtension("WEBGL_debug_renderer_info"),u=t.getParameter(r.UNMASKED_VENDOR_WEBGL),f=t.getParameter(r.UNMASKED_RENDERER_WEBGL);n("WebGL Vendor: "+u+"; WebGL Renderer: "+f)})}function getWebRTCFingerprint(){return new Promise(n=>{var r=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,t,i;if(!r){n("WebRTC not supported");return}t=new r({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});i=new Set;t.createDataChannel("");t.createOffer().then(n=>t.setLocalDescription(n));t.onicecandidate=function(r){if(r.candidate){var u=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g.exec(r.candidate.candidate);u&&i.add(u[1])}else n(Array.from(i).join(", ")||"unknown"),t.close()}})}async function hashString(n){const t=new TextEncoder,i=t.encode(n),r=await crypto.subtle.digest("SHA-256",i),u=Array.from(new Uint8Array(r));return u.map(n=>n.toString(16).padStart(2,"0")).join("")}function getUserAgent(){return navigator.userAgent}function getBrowserPlugins(){for(var t=[],n=0;n<navigator.plugins.length;n++)t.push(navigator.plugins[n].name);return t.join(", ")}function getTouchSupport(){var n={hasTouch:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,maxTouchPoints:0};return navigator.maxTouchPoints?n.maxTouchPoints=navigator.maxTouchPoints:navigator.msMaxTouchPoints&&(n.maxTouchPoints=navigator.msMaxTouchPoints),n}function hasSessionStorage(){try{return!!window.sessionStorage}catch(n){return!1}}function hasLocalStorage(){try{return!!window.localStorage}catch(n){return!1}}function hasIndexedDB(){try{return!!window.indexedDB}catch(n){return!1}}function hasAddBehavior(){return!!document.body.addBehavior}function hasOpenDatabase(){return!!window.openDatabase}function detectFonts(){const n=["monospace","sans-serif","serif"],t="mmmmmmmmmmlli",i="72px",r=document.getElementsByTagName("body")[0],u=n.map(n=>{let u=document.createElement("span");return u.style.fontSize=i,u.innerHTML=t,u.style.fontFamily=n,r.appendChild(u),u}),f=["Arial","Arial Black","Comic Sans MS","Courier New","Georgia","Impact","Times New Roman","Trebuchet MS","Verdana","Webdings"].filter(f=>{let o=!1,e=document.createElement("span");return e.style.fontSize=i,e.innerHTML=t,e.style.fontFamily=`${f},${n[0]}`,r.appendChild(e),o=u.every(n=>e.offsetWidth!==n.offsetWidth||e.offsetHeight!==n.offsetHeight),e.remove(),o});return u.forEach(n=>n.remove()),f}function getLogicalProcessors(){return navigator.hardwareConcurrency||"unknown"}function getDeviceMemory(){return navigator.deviceMemory||"unknown"}async function getCameraInfo(){try{const n=await navigator.mediaDevices.enumerateDevices();return n.filter(n=>n.kind==="videoinput")}catch(n){return"Camera access denied or not available"}}function gatherDeviceInfo(){var n=getTouchSupport();return{screenWidth:window.screen.width,screenHeight:window.screen.height,colorDepth:window.screen.colorDepth,devicePixelRatio:window.devicePixelRatio,pixelCount:window.screen.width*window.screen.height,touchSupport:n.hasTouch,maxTouchPoints:n.maxTouchPoints,browserLanguage:navigator.language,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,platform:navigator.platform,userAgent:getUserAgent(),browserPlugins:getBrowserPlugins()}}function gatherExtendedDeviceInfo(){const n={hasSessionStorage:hasSessionStorage(),hasLocalStorage:hasLocalStorage(),hasIndexedDB:hasIndexedDB(),hasAddBehavior:hasAddBehavior(),hasOpenDatabase:hasOpenDatabase(),logicalProcessors:getLogicalProcessors(),deviceMemory:getDeviceMemory()};return Promise.all([detectFonts(),getCameraInfo()]).then(([i,t])=>(n.detectedFonts=i,n.cameraInfo=t,n)).catch(()=>n)}function gatherAndSendFingerprintData(){Promise.all([getCanvasFingerprint(),getWebGLFingerprint(),getWebRTCFingerprint(),gatherDeviceInfo(),gatherExtendedDeviceInfo()]).then(n=>{var t=n[0],i=n[1],r=n[2],u=n[3],f=n[4],e=Object.assign({},u,f);sendFingerprintDataToAPI(t,i,r,e)}).catch(n=>{console.error("Error in fingerprint generation:",n)})}function sendFingerprintDataToAPI(n,t,i,r){var f=localStorage.getItem("heatleadValue"),e=localStorage.getItem("sessionToken"),o={HeatLeadTrackingCode:f,SessionToken:e,CanvasFingerprint:n,WebGLFingerprint:t,WebRTCFingerprint:i,ScreenWidth:r.screenWidth,ScreenHeight:r.screenHeight,pixelCount:r.pixelCount,ColorDepth:r.colorDepth,DevicePixelRatio:r.devicePixelRatio,TouchSupport:r.touchSupport,MaxTouchPoints:r.maxTouchPoints,BrowserLanguage:r.browserLanguage,TimeZone:r.timeZone,Platform:r.platform,UserAgent:r.userAgent,BrowserPlugins:r.browserPlugins,HasSessionStorage:r.hasSessionStorage,HasLocalStorage:r.hasLocalStorage,HasIndexedDB:r.hasIndexedDB,HasAddBehavior:r.hasAddBehavior,HasOpenDatabase:r.hasOpenDatabase,LogicalProcessors:r.logicalProcessors.toString(),DeviceMemory:r.deviceMemory.toString(),DetectedFonts:JSON.stringify(r.detectedFonts),CameraInfo:JSON.stringify(r.cameraInfo)},u=new XMLHttpRequest;u.open("POST","https://eksperci.myjki.com/api/fingerprint",!0);u.setRequestHeader("Content-Type","application/json; charset=UTF-8");u.send(JSON.stringify(o));u.onload=function(){u.status>=200&&u.status<300};u.onerror=function(){}}gatherAndSendFingerprintData();